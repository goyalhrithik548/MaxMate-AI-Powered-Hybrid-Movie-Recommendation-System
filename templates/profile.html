<!DOCTYPE html>
<html>
<head>
  <title>MAXMATE - Profile</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='style.css') }}">
  <style>
      .profile-header { padding: 40px 50px; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 20px; }
      .avatar { width: 80px; height: 80px; background-color: #E50914; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: bold; color: white; }
      .section-title { margin: 30px 50px 10px; font-size: 1.5rem; color: #999; border-bottom: 1px solid #333; padding-bottom: 10px; }
      .grid-container { display: flex; flex-wrap: wrap; gap: 15px; padding: 20px 50px; }
      .grid-card { width: 150px; cursor: pointer; transition: transform 0.2s; position: relative; }
      .grid-card:hover { transform: scale(1.05); z-index: 10; }
      .grid-card img { width: 100%; border-radius: 4px; box-shadow: 0 4px 8px rgba(0,0,0,0.5); }
      .empty-msg { margin-left: 50px; color: #555; font-style: italic; }
  </style>
</head>
<body style="background-color: #141414; color: white;">

    <nav class="navbar-custom">
        <div class="logo" onclick="window.location.href='{{ url_for('home') }}'">MAXMATE</div>
        <div class="nav-right">
            <a href="{{ url_for('home') }}" style="color: white; text-decoration: none; margin-right: 20px;">Home</a>
            <a href="{{ url_for('logout') }}" class="logout-link">Logout</a>
        </div>
    </nav>

    <div class="main-content" style="margin-top: 70px;">
        <div class="profile-header">
            <div class="avatar">{{ username[0]|upper }}</div>
            <div>
                <h1>{{ username }}</h1>
                <p style="color: #777;">Member</p>
            </div>
        </div>

        <h3 class="section-title"><i class="fa fa-heart" style="color: #E50914;"></i> Liked Movies</h3>
        {% if liked_movies %}
            <div class="grid-container">
                {% for movie in liked_movies %}
                <div class="grid-card" onclick="recommend('{{ movie.title }}', '{{ movie.id }}')">
                    <img src="{{ movie.poster }}" alt="{{ movie.title }}" onerror="this.src='https://placehold.co/300x450?text=No+Image'">
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="empty-msg">You haven't liked any movies yet.</p>
        {% endif %}

        <h3 class="section-title"><i class="fa fa-bookmark" style="color: #dba506;"></i> My Watchlist</h3>
        {% if saved_movies %}
            <div class="grid-container">
                {% for movie in saved_movies %}
                <div class="grid-card" onclick="recommend('{{ movie.title }}', '{{ movie.id }}')">
                    <img src="{{ movie.poster }}" alt="{{ movie.title }}" onerror="this.src='https://placehold.co/300x450?text=No+Image'">
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="empty-msg">Your watchlist is empty.</p>
        {% endif %}
    </div>

    <div class="results" style="display:none;"></div>
    <div class="fail" style="display:none;"><center><h3>Sorry! try another movie name</h3></center></div>
    <div id="loader" class="text-center" style="display:none;"></div>

    <input type="hidden" id="autoComplete">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script type="text/javascript" src="{{url_for('static', filename='recommend.js')}}"></script>

<div id="chat-circle" class="btn btn-raised">
    <img src="{{ url_for('static', filename='chatbot-icon.png') }}" alt="AI Chat">
</div>

    <div class="chat-box">
        <div class="chat-box-header">
            Hey Max
            <span class="chat-box-toggle"><i class="material-icons">close</i></span>
        </div>
        <div class="chat-box-body">
            <div class="chat-logs">
                <div class="chat-msg bot">
                    <span class="cm-msg-text">Hi! I'm your movie assistant. Ask me anything!</span>
                </div>
            </div>
        </div>
        <div class="chat-input">
            <form style="display: flex; width: 100%;">
                <input type="text" id="chat-input" placeholder="Find a movie..." />
                <button type="submit" class="chat-submit" id="chat-submit">
                    <i class="material-icons">send</i>
                </button>
            </form>
        </div>
    </div>

</body>
</html>